define(["jquery","core/log"],(function($,log){var selectors_player="_fpminimal_audioplayer",selectors_ppbutton="_fpminimal_audioplayer .fpminimal_audioplayer_play_button",selectors_bar_front="_fpminimal_audioplayer .fpminimal_audioplayer_bar_front",selectors_backbutton="_fpminimal_audioplayer .fpminimal_audioplayer_skip_button_back",selectors_forwardbutton="_fpminimal_audioplayer .fpminimal_audioplayer_skip_button_forward",selectors_timedisplay="_fpminimal_audioplayer .fpminimal_audioplayer_time";return{init:function(opts){this.hplayer=$(opts.player_element)[0],log.debug(opts.player_element),log.debug(opts.autoid),log.debug(opts),1!=$(this.hplayer).data("init")&&($(this.hplayer).data("init",1),this.vplayer=$("#"+opts.autoid+selectors_player),this.ppbutton=$("#"+opts.autoid+selectors_ppbutton),this.bar_front=$("#"+opts.autoid+selectors_bar_front),this.backbutton=$("#"+opts.autoid+selectors_backbutton),this.forwardbutton=$("#"+opts.autoid+selectors_forwardbutton),this.timedisplay=$("#"+opts.autoid+selectors_timedisplay),this.duration=this.hplayer.duration,log.debug("duration is "+this.duration),this.register_events(),this.update_time())},register_events:function(){var that=this;$(this.ppbutton).on("click",(function(){that.toggle_play()})),$(this.backbutton).on("click",(function(){that.skip_back()})),$(this.forwardbutton).on("click",(function(){that.skip_forward()})),$(this.hplayer).on("timeupdate",(function(){that.update_time()})),$(this.hplayer).on("ended",(function(){$(that.ppbutton).attr("data-state","ended"),$(that.timedisplay).text(that.formatAudioTime(that.duration))})),$(this.hplayer).on("pause play",(function(e){e.currentTarget.paused?$(that.ppbutton).attr("data-state","paused"):$(that.ppbutton).attr("data-state","playing")})),$(this.hplayer).on("loadeddata",(function(){console.log("loadeddata",that.hplayer.duration),that.hplayer.duration===1/0?that.duration=$(that.hplayer).data("duration"):that.duration=that.hplayer.duration,$(that.ppbutton).attr("data-state","paused"),that.update_time()})),$(this.hplayer).on("canplaythrough",(function(){that.hplayer.duration!==1/0&&(that.duration=that.hplayer.duration)}))},toggle_play:function(){var that=this;this.hplayer.paused?(this.hplayer.muted=!1,console.log(this.hplayer),this.hplayer.play().then((function(){log.debug("play promise resolved"),$(that.ppbutton).attr("data-state","playing")})).catch((function(e){log.debug(e,"play promise rejected")}))):(this.hplayer.pause(),$(that.ppbutton).attr("data-state","paused"))},update_time:function(){var percent=0;switch(parseInt(this.duration)>0?(percent=this.hplayer.currentTime/this.duration*100)>100&&(percent=100):this.duration=0,$(this.bar_front).css("width",percent+"%"),percent){case 0:case 100:$(this.timedisplay).text(this.formatAudioTime(this.duration));break;default:$(this.timedisplay).text(this.formatAudioTime(this.hplayer.currentTime)+"/"+this.formatAudioTime(this.duration))}this.hplayer.currentTime<15?$(this.backbutton).css("opacity","50%"):$(this.backbutton).css("opacity","100%"),this.hplayer.currentTime>this.duration-15?$(this.forwardbutton).css("opacity","50%"):$(this.forwardbutton).css("opacity","100%")},skip_back:function(){this.hplayer.currentTime>15?this.hplayer.currentTime=this.hplayer.currentTime-15:this.hplayer.currentTime=0},skip_forward:function(){this.hplayer.currentTime<this.duration-15?this.hplayer.currentTime=this.hplayer.currentTime+15:this.hplayer.currentTime=this.duration},formatAudioTime:function(currentTime){const minutes=Math.floor(currentTime/60),seconds=Math.floor(currentTime%60);return"".concat(String(minutes).padStart(2,"0"),":").concat(String(seconds).padStart(2,"0"))}}}));

//# sourceMappingURL=audioplayer_minimal.min.js.map