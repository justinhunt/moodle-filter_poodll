define(["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";return b.debug("Filter PoodLL: utils initialising"),{timeouthandles:[],WhiteboardUploadHandler:function(b,d,e){var f=a("#"+b+"_btn_upload_whiteboard")[0];f.disabled=!0,clearTimeout(this.timeouthandles[b]);var g=this.getCvs(b,d,e);this.pokeVectorData(b,d,e),c.uploadFile(g.toDataURL(),"image")},getCvs:function(a,b){if(0==a.indexOf("drawingboard_"))var c=b.canvas;else var c=b.canvasForExport();return c},escapeColon:function(a){return a.replace(/:/,"\\:")},pokeVectorData:function(c,d,e){var f="";f=0==c.indexOf("drawingboard_")?JSON.stringify(d.history,null,2):JSON.stringify(d.getSnapshot()),"undefined"!=typeof e.vectorcontrol&&""!==e.vectorcontrol&&(a("#"+this.escapeColon(e.vectorcontrol)).val(f),b.debug("Vectorcontrol:"+e.vectorcontrol),b.debug("Vectordata:"+f))},concatenateWavBlobs:function(a,b){for(var c=[],d=0,e=0,f=a.length,g=0;f>g;g++){var h=new FileReader;h.onload=function(){var a=this.result,g=a.slice(44);if(e+=g.byteLength,c.push(g),d++,d==f){var h=a.slice(0,44),i=new DataView(h);i.setUint32(40,e,!0),c.unshift(h);var j=new Blob(c,{type:"audio/wav"});b(j)}},h.readAsArrayBuffer(a[g])}}}});